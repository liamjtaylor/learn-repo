{{ config(materialized='table') }}

with

  source as (
    select * from {{source('airbnb','listings')}}
  )

select
  ACCEPTANCE_RATE,
  ACCOMMODATES,
  AVAILABILITY_60,
  CANCELLATION_POLICY,
  LONGITUDE,
  SCRAPE,
  SQUARE_FEET,
  BATHROOMS,
  HOST_ID,
  REVIEW_SCORES_CHECKIN,
  ID,
  LAST_REVIEW,
  TRANSIT,
  AVAILABILITY_90,
  BEDROOMS,
  COUNTRY_CODE,
  HOST_IDENTITY_VERIFIED,
  HOST_NAME,
  INTERACTION,
  LICENSE,
  GUESTS_INCLUDED,
  JURISDICTION_NAMES,
  nullif(replace(split_part(PRICE, '$', 2), ',', ''), '')::float as PRICE,
  REVIEW_SCORES_LOCATION,
  REVIEW_SCORES_VALUE,
  STATE,
  REVIEW_SCORES_COMMUNICATION,
  HOUSE_RULES,
  EXTRA_PEOPLE,
  IS_LOCATION_EXACT,
  NOTES,
  SMART_LOCATION,
  DESCRIPTION,
  RESPONSE_RATE,
  SECURITY_DEPOSIT,
  WEEKLY_PRICE,
  AVAILABILITY_365,
  MAXIMUM_NIGHTS,
  MONTHLY_PRICE,
  CLEANING_FEE,
  HAS_AVAILABILITY,
  NAME,
  NUMBER_OF_REVIEWS,
  ZIPCODE,
  IS_BUSINESS_TRAVEL_READY,
  AVAILABILITY_30,
  BED_TYPE,
  HOST_HAS_PROFILE_PIC,
  HOST_NEIGHBOURHOOD,
  BEDS,
  HOST_SINCE,
  MARKET,
  REQUIRE_GUEST_PHONE_VERIFICATION,
  RESPONSE_TIME,
  REVIEW_SCORES_ACCURACY,
  INSTANT_BOOKABLE,
  CITY,
  EXPERIENCES_OFFERED,
  LATITUDE,
  MINIMUM_NIGHTS,
  NEIGHBORHOOD_OVERVIEW,
  REQUIRES_LICENSE,
  HOST_LOCATION,
  PROPERTY_TYPE,
  REVIEW_SCORES_RATING,
  SPACE,
  STREET,
  ROOM_TYPE,
  IS_SUPERHOST,
  COUNTRY,
  FIRST_REVIEW,
  HOST_ABOUT,
  NEIGHBOURHOOD_GROUP_CLEANSED,
  NEIGHBOURHOOD,
  REVIEW_SCORES_CLEANLINESS,
  HOST_VERIFICATIONS,
  SUMMARY,
  ACCESS,
  CALENDAR_UPDATED,
  NEIGHBOURHOOD_CLEANSED,
  REQUIRE_GUEST_PROFILE_PICTURE,
  URL,
  AMENITIES
from source
